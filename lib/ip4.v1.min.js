"use strict";var ip4=(ip4||{});ip4.version="v1 2014-02-13T13:31:54+00:00";ip4.log=function(){var level={current:1,trace:5,log:4,info:3,time:2,warn:1,error:0}
return{level:function(){return level;}(),trace:function(){return level.current>=level.trace;},log:function(){return level.current>=level.log;},info:function(){return level.current>=level.info;},time:function(){return level.current>=level.time;},warn:function(){return level.current>=level.warn;},error:function(){return level.current>=level.error;}}}();ip4.log.toString=function(log){switch(log){case 0:return"ip4.log.level.error";case 1:return"ip4.log.level.warn";case 2:return"ip4.log.level.time";case 3:return"ip4.log.level.info";case 4:return"ip4.log.level.log";case 5:return"ip4.log.level.trace";default:return"ip4.log.level.undefined";}};ip4.log.fromString=function(s){switch(s){case"ip4.log.level.error":return 0;case"ip4.log.level.warn":return 1;case"ip4.log.level.time":return 2;case"ip4.log.level.info":return 3;case"ip4.log.level.log":return 4;case"ip4.log.level.trace":return 5;default:return 1;}}
if(!ip4.load)ip4.load={}
ip4.load.Loader=function(configuration){this.configuration(configuration);}
ip4.load.Loader.prototype={constructor:{configurable:true,enumerable:true,value:ip4.load.Loader,writable:true}}
ip4.load.Loader.prototype.toString=function(){return"[ip4 Loader]";}
ip4.load.Loader.prototype.configuration=function(configuration){if(arguments.length===0)return this._configuration;this._configuration=configuration;return this;}
ip4.load.Loader.prototype.run=function(){if(ip4.log.log())console.log(this.toString()+" Running...");var conf=this.configuration();if(conf.log){if(ip4.log.info())console.info(this.toString()+" Setting ip4.log.level.current="+ip4.log.toString(conf.log));ip4.log.level.current=conf.log;}
if(!conf.template){if(ip4.log.error())console.error(this.toString()+" No template found");return 0;}
if(!conf.parentElement){if(ip4.log.warn())console.warn(this.toString()+" No parent element defined. Appending <div> to <body> element");conf.parentElement=d3.select("body").append("div");}
if(typeof conf.parentElement==="string")conf.parentElement=d3.select(conf.parentElement);conf.template.configuration(conf);}
ip4.draw=function(configuration){new ip4.load.Loader(configuration).run();}
if(!ip4.util)ip4.util={}
ip4.util.isSvgSupport=function(){return window.SVGSVGElement;}
ip4.util.isTouchDevice=function(){return'ontouchstart'in window||'onmsgesturechange'in window;}
ip4.util.isUrl=function(uri){return(/^http:\/\//).test(uri)||(/^https:\/\//).test(uri)}
ip4.util.mixin=function(receiver,supplier,parent){if(supplier==null||receiver==null)
return receiver;for(var p in supplier){if(parent==="transitions"){receiver[p]=supplier[p];continue;}
if(!receiver.hasOwnProperty(p)&&supplier.hasOwnProperty(p))
receiver[p]=supplier[p];if(typeof supplier[p]==="object"&&supplier.hasOwnProperty(p))
this.mixin(receiver[p],supplier[p],p);}
return receiver;}
ip4.util.isPath=function(obj,path){path=path.split(".");var p=obj||{};for(var i in path){if(p===null||p[path[i]]===undefined)return null;p=p[path[i]];}
return p;}
ip4.util.getRandomMinMax=function(min,max){return Math.random()*(max-min)+min;}
ip4.util.getRandom=function(){return Math.random();}
ip4.util.getRandomPoints=function(count,min,max){var points=[];for(var i=0;i<count;i++){points.push({"x":i,"y":ip4.util.getRandomMinMax(min,max)});}
return points;}
if(!ip4.color)ip4.color={}
ip4.color.name2hex=function(name){return(typeof name==="string")?(ip4.color.names[name.toLowerCase()]||undefined):name;}
ip4.color.hex2rgb=function(a){var b,c;a=a.replace(/^#?([a-f\d])([a-f\d])([a-f\d])$/i,function(a,b,c){return a+a+b+b+c+c});b=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(a);a=parseInt(b[1],16);c=parseInt(b[2],16);b=parseInt(b[3],16);return[a,c,b];}
ip4.color.hex2hsv=function(a){return ip4.color.rgb2hsv(ip4.color.hex2rgb(a));},ip4.color.rgb2hex=function(a){var b="",c,d;for(d=0;d<a.length;d+=1)
c=a[d],c=c.toString(16),c=1===c.length?"0"+c:c,b+=c;return"#"+b;}
ip4.color.rgb2hsv=function(a){var b=a[0],c=a[1];a=a[2];var d=Math.min(b,c,a),f=Math.max(b,c,a),e=f-d,j=f,j=Math.floor(100*(f/255));if(0!==f)
d=Math.floor(100*(e/f));else return[0,0,0];b=Math.floor(60*(b===f?(c-a)/e:c===f?2+(a-b)/e:4+(b-c)/e));0>b&&(b+=360);return[b,d,j]}
ip4.color.hsv2hex=function(a){return this.rgb2hex(ip4.color.hsv2rgb(a));}
ip4.color.hsv2rgb=function(a){var b,c,d,f,e,j,h;e=a[0];h=a[1];var g=a[2];e=Math.max(0,Math.min(360,e));h=Math.max(0,Math.min(100,h));g=Math.max(0,Math.min(100,g));h/=100;g/=100;if(0===h)return b=c=d=g,[Math.round(255*b),Math.round(255*c),Math.round(255*d)];e/=60;a=Math.floor(e);f=e-a;e=g*(1-h);j=g*(1-h*f);h=g*(1-h*(1-f));switch(a){case 0:b=g;c=h;d=e;break;case 1:b=j;c=g;d=e;break;case 2:b=e;c=g;d=h;break;case 3:b=e;c=j;d=g;break;case 4:b=h;c=e;d=g;break;case 5:b=g,c=e,d=j}
b=Math.round(255*b);c=Math.round(255*c);d=Math.round(255*d);return[b,c,d]}
ip4.color.random=function(count){var a=count,b=[],c;a="number"!==typeof a?1:a;for(c=0;c<a;c+=1)
b.push("#"+Math.floor(16777215*Math.random()).toString(16));return b.length>1?b:b[0];}
ip4.color.complement=function(color,type){var a=ip4.color.name2hex(color)||color,c=1,d=180,f=0;switch(type){case"split":c=3;f=d=180;break;case"double":c=5,f=d=180;}
return ip4.color.rotationalDispersion(a,c,"hue",f,d);}
ip4.color.triadic=function(color){var a=ip4.color.name2hex(color)||color;return ip4.color.rotationalDispersion(a,3,"hue",360,0);}
ip4.color.tetradic=function(color){var a=ip4.color.name2hex(color)||color;return ip4.color.rotationalDispersion(a,4,"hue",360,0);}
ip4.color.pentadic=function(color){var a=ip4.color.name2hex(color)||color;return ip4.color.rotationalDispersion(a,5,"hue",360,0);}
ip4.color.decadic=function(color){var a=ip4.color.name2hex(color)||color;return ip4.color.rotationalDispersion(a,10,"hue",360,0);}
ip4.color.rotationalDispersion=function(color,count,type,scope,rotation){var a=ip4.color.name2hex(color)||color,b=count,c=type,d=scope,f=rotation;b="number"!==typeof b?3:b;c="string"!==typeof c?3:c;d="number"!==typeof d?360:d;f="number"!==typeof f?0:f;var e=ip4.color.hex2hsv(a);a=e[0];var j=e[1],e=e[2],h,g=[],k;h="hue"===c&&(360===d||0===d)?d/b:d/(b-1);d=360===d?0:ip4.color.degrees(ip4.color.degrees(a,f),-1*d/2);for(k=0;k<b;k+=1)
switch(f=h*k,c){case"hue":g.unshift(ip4.color.hsv2hex([ip4.color.degrees(d,f,360),j,e]));break;case"saturation":g.unshift(ip4.color.hsv2hex([a,f,e]));break;case"value":case"lightness":case"brightness":g.unshift(ip4.color.hsv2hex([a,j,f]));}
return g;}
ip4.color.degrees=function(color,b){var a=ip4.color.name2hex(color)||color;a+=b;360<a?a-=360:0>a&&(a+=360);return a;}
ip4.color.shade=function(color,factor){var hex=ip4.color.name2hex(color)||color,num=parseInt(hex.slice(1),16),amt=Math.round(255*factor),R=(num>>16)+amt,G=(num>>8&0x00FF)+amt,B=(num&0x0000FF)+amt;return"#"+(0x1000000+(R<255?R<1?0:R:255)*0x10000+(G<255?G<1?0:G:255)*0x100+(B<255?B<1?0:B:255)).toString(16).slice(1);}
ip4.color.shades=function(color,count){var hex=ip4.color.name2hex(color)||color,count=count||10,shades=[];for(var i=0;i<count;i++){shades.push(ip4.color.shade(hex,i*1/(count)));}
return shades;}
ip4.color.kuler={"sandy_stone_beach_ocean_diver":["#002F2F","#046380","#A7A37E","#E6E2AF","#EFECCA"],"firenze":["#468966","#8E2800","#B64926","#FFB03B","#FFF0A5"],"neutral_blue":["#193441","#3E606F","#91AA9D","#D1DBBD","#FCFFF5"],"cherry_cheesecake":["#4C1B1B","#B9121B","#BD8D46","#F6E497","#FCFAE1"],"watermelon":["#7D8A2E","#C9D787","#FF8598","#FFC0A9","#FFFFFF"],"mustang1944":["#000000","#263248","#7E8AA2","#FF9800","#FFFFFF"],"orange_on_gray":["#33332D","#9FB4CC","#CCCC9F","#DB4105","#FFF8E3"],"honey_pot":["#105B63","#BD4932","#DB9E36","#FFD34E","#FFFAD5"],"japanese_garden":["#284907","#363942","#382513","#5C832F","#D8CAA8"],"sea_wolf":["#DC3522","#D9CB9E","#374140","#2A2C2B","#1E1E20"],"flat_design":["#334D5C","#45B29D","#DF5A49","#E27A3F","#EFC94C"],"info_ready_brand_option_2":["#2C3E50","#6DBCDB","#D7DADB","#FC4349","#FFFFFF"],"vintage_card":["#5C4B51","#8CBEB2","#F06060","#F2EBBF","#F3B562"],"data_driven":["#1CAF9A","#1D2939","#D1DC48","#EE4F4B","#FFFFFF"],"beer":["#329996","#37324A","#933C60","#F3A358","#F8DB9A"],"a_hipster_palette":["#42282E","#75A48B","#D9CFB0","#DC9B74","#D6665A"],"eco":["#103636","#108F97","#16866D","#FF8B6B","#FFE39F"],"nimbus":["#023550","#028A9E","#04BFBF","#EFEFEF","#FF530D"],"calmness":["#4A7680","#707D80","#89EBFF","#B3C8CC","#E0FAFF"],"tasty":["#1E4147","#437356","#AAC789","#F34A53","#FAE3B4"]}
ip4.color.names={"aliceblue":"#f0f8ff","antiquewhite":"#faebd7","aqua":"#00ffff","aquamarine":"#7fffd4","azure":"#f0ffff","beige":"#f5f5dc","bisque":"#ffe4c4","black":"#000000","blanchedalmond":"#ffebcd","blue":"#0000ff","blueviolet":"#8a2be2","brown":"#a52a2a","burlywood":"#deb887","burntsienna":"#ea7e5d","cadetblue":"#5f9ea0","chartreuse":"#7fff00","chocolate":"#d2691e","coral":"#ff7f50","cornflowerblue":"#6495ed","cornsilk":"#fff8dc","crimson":"#dc143c","cyan":"#00ffff","darkblue":"#00008b","darkcyan":"#008b8b","darkgoldenrod":"#b8860b","darkgray":"#a9a9a9","darkgreen":"#006400","darkgrey":"#a9a9a9","darkkhaki":"#bdb76b","darkmagenta":"#8b008b","darkolivegreen":"#556b2f","darkorange":"#ff8c00","darkorchid":"#9932cc","darkred":"#8b0000","darksalmon":"#e9967a","darkseagreen":"#8fbc8f","darkslateblue":"#483d8b","darkslategray":"#2f4f4f","darkslategrey":"#2f4f4f","darkturquoise":"#00ced1","darkviolet":"#9400d3","deeppink":"#ff1493","deepskyblue":"#00bfff","dimgray":"#696969","dimgrey":"#696969","dodgerblue":"#1e90ff","firebrick":"#b22222","floralwhite":"#fffaf0","forestgreen":"#228b22","fuchsia":"#ff00ff","gainsboro":"#dcdcdc","ghostwhite":"#f8f8ff","gold":"#ffd700","goldenrod":"#daa520","gray":"#808080","green":"#008000","greenyellow":"#adff2f","grey":"#808080","honeydew":"#f0fff0","hotpink":"#ff69b4","indianred":"#cd5c5c","indigo":"#4b0082","ivory":"#fffff0","khaki":"#f0e68c","lavender":"#e6e6fa","lavenderblush":"#fff0f5","lawngreen":"#7cfc00","lemonchiffon":"#fffacd","lightblue":"#add8e6","lightcoral":"#f08080","lightcyan":"#e0ffff","lightgoldenrodyellow":"#fafad2","lightgray":"#d3d3d3","lightgreen":"#90ee90","lightgrey":"#d3d3d3","lightpink":"#ffb6c1","lightsalmon":"#ffa07a","lightseagreen":"#20b2aa","lightskyblue":"#87cefa","lightslategray":"#778899","lightslategrey":"#778899","lightsteelblue":"#b0c4de","lightyellow":"#ffffe0","lime":"#00ff00","limegreen":"#32cd32","linen":"#faf0e6","magenta":"#ff00ff","maroon":"#800000","mediumaquamarine":"#66cdaa","mediumblue":"#0000cd","mediumorchid":"#ba55d3","mediumpurple":"#9370db","mediumseagreen":"#3cb371","mediumslateblue":"#7b68ee","mediumspringgreen":"#00fa9a","mediumturquoise":"#48d1cc","mediumvioletred":"#c71585","midnightblue":"#191970","mintcream":"#f5fffa","mistyrose":"#ffe4e1","moccasin":"#ffe4b5","navajowhite":"#ffdead","navy":"#000080","oldlace":"#fdf5e6","olive":"#808000","olivedrab":"#6b8e23","orange":"#ffa500","orangered":"#ff4500","orchid":"#da70d6","palegoldenrod":"#eee8aa","palegreen":"#98fb98","paleturquoise":"#afeeee","palevioletred":"#db7093","papayawhip":"#ffefd5","peachpuff":"#ffdab9","peru":"#cd853f","pink":"#ffc0cb","plum":"#dda0dd","powderblue":"#b0e0e6","purple":"#800080","red":"#ff0000","rosybrown":"#bc8f8f","royalblue":"#4169e1","saddlebrown":"#8b4513","salmon":"#fa8072","sandybrown":"#f4a460","seagreen":"#2e8b57","seashell":"#fff5ee","sienna":"#a0522d","silver":"#c0c0c0","skyblue":"#87ceeb","slateblue":"#6a5acd","slategray":"#708090","slategrey":"#708090","snow":"#fffafa","springgreen":"#00ff7f","steelblue":"#4682b4","tan":"#d2b48c","teal":"#008080","thistle":"#d8bfd8","tomato":"#ff6347","turquoise":"#40e0d0","violet":"#ee82ee","wheat":"#f5deb3","white":"#ffffff","whitesmoke":"#f5f5f5","yellow":"#ffff00","yellowgreen":"#9acd32"}
ip4.color.default_palette=ip4.color.kuler.flat_design;if(!ip4.document)ip4.document={}
ip4.document.Document=function(){window.addEventListener("resize",this.resize.bind(this),false);window.addEventListener("orientationchange",this.resize.bind(this),false);}
ip4.document.Document.prototype={constructor:{configurable:true,enumerable:true,value:ip4.document.Document,writable:true}}
ip4.document.Document.prototype.toString=function(){return"[ip4 Document]";}
ip4.document.Document.prototype.configuration=function(configuration){if(arguments.length===0){return ip4.util.mixin(this._configuration||{},this.defaultConfiguration());}
this._configuration=configuration;this.resize();return this;}
ip4.document.Document.prototype.draw=function(){}
ip4.document.Document.prototype.redraw=function(){}
ip4.document.Document.prototype.resize=function(){}
ip4.document.SVGDocument=function(){ip4.document.Document.call(this);}
ip4.document.SVGDocument.prototype=Object.create(ip4.document.Document.prototype,{constructor:{configurable:true,enumerable:true,value:ip4.document.SVGDocument,writable:true}});ip4.document.SVGDocument.prototype.toString=function(){return"[ip4 SVGDocument]";}
ip4.document.SVGDocument.prototype.draw=function(){ip4.document.Document.prototype.draw.call(this);var conf=this.configuration(),parent=conf.parentElement;if(!ip4.util.isSvgSupport()){if(ip4.log.warn())console.warn(this.toString()+" Browser has no SVG support");var noSvgText="Your browser doesn't support SVG. Use a newer browser to view the chart.";if(conf.svg.alt){var alt=conf.svg.alt,noSvgText=alt.noSvgText||noSvgText;if(alt.img){parent.append("img").attr({"src":alt.img,"title":alt.title});}}else{parent.append("p").style("color","red").text(noSvgText);}
return;}
if(parent.select("svg.ip4").empty()){var svg=parent.append("svg").classed("ip4",true);svg.append("g").classed("main",true).attr("transform","translate("+(conf.svg.size.margin.left||0)+","+(conf.svg.size.margin.top||0)+")");svg.append("g").classed("message",true).attr("transform","translate("+(conf.svg.size.width/2)+","+(conf.svg.size.height/2)+")").append("text");if(conf.svg.desc){svg.append("desc").text(conf.svg.desc);}
if(conf.svg.metadata){var metadata=conf.svg.metadata;d3.ns.prefix.rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#";d3.ns.prefix.rdfs="http://www.w3.org/2000/01/rdf-schema#";d3.ns.prefix.dc="http://purl.org/dc/elements/1.1/";var description=svg.append("metadata").append("rdf:RDF").attr("xmlns:rdf",d3.ns.prefix.rdf.space).attr("xmlns:rdfs",d3.ns.prefix.rdfs.space).attr("xmlns:dc",d3.ns.prefix.dc.space).append("rdf:Description");for(var prop in metadata){description.attr(prop,metadata[prop]);}}}}
ip4.document.SVGDocument.prototype.redraw=function(error,data){ip4.document.Document.prototype.redraw.call(this);var conf=this.configuration(),parent=conf.parentElement,message=parent.select("g.message");if(error){if(ip4.log.error())console.error(this.toString()+" Error:",error);var errorMessage=error.statusText||"Failed to load data.";switch(error.status){case 0:errorMessage+=" Couldn't connect to the server.";break;}
message.select("text").attr("class","error").text(errorMessage);return;}else{message.select("text").text(null);}}
ip4.document.SVGDocument.prototype.resize=function(){if(ip4.log.log())console.log(this.toString()+" Resizeing...");ip4.document.Document.prototype.resize.call(this);var conf=this.configuration(),parent=conf.parentElement;if(parent){parent.select("svg.ip4").remove();conf.svg.size.width=parent.node().offsetWidth;conf.svg.size.height=(conf.svg.size.aspectRatio||0.6)*conf.svg.size.width;this.draw();parent.select("svg.ip4").attr("width",conf.svg.size.width).attr("height",conf.svg.size.height);}}
if(!ip4.data)ip4.data={}
ip4.data.DataReader=function(){}
ip4.dataReader=function(){return new ip4.data.DataReader();}
ip4.data.DataReader.prototype={constructor:{configurable:true,enumerable:true,value:ip4.data.DataReader,writable:true}}
ip4.data.DataReader.prototype.toString=function(){return"[ip4 DataReader]";}
ip4.data.DataReader.prototype.uri=function(uri,mimetype){if(arguments.length===0)return this._uri;this._uri=uri;if(mimetype)this.mimetype(mimetype);return this;}
ip4.data.DataReader.prototype.data=function(data,mimetype){if(arguments.length===0)return this._data;this._data=data;if(mimetype)this.mimetype(mimetype);return this;}
ip4.data.DataReader.prototype.mimetype=function(mimetype){if(arguments.length===0)return this._mimetype;this._mimetype=mimetype;return this;}
ip4.data.DataReader.prototype.callback=function(callback){if(arguments.length===0)return this._callback;this._callback=callback;return this;}
ip4.data.DataReader.prototype.adapter=function(adapter){if(arguments.length===0)return this._adapter;this._adapter=adapter;return this;}
ip4.data.DataReader.prototype.interval=function(interval){if(arguments.length===0)return this._interval;this._interval=interval;return this;}
ip4.data.DataReader.prototype.intervalId=function(intervalId){if(arguments.length===0)return this._intervalId;this._intervalId=intervalId;return this;}
ip4.data.DataReader.prototype.startInterval=function(interval){var interval=interval||this.interval(),callback=this.callback();if(this.intervalId())this.stopInterval();if(!this.intervalId()&&interval&&interval>0){var self=this;this.intervalId(window.setInterval(function(){self.read(callback);},+interval));}}
ip4.data.DataReader.prototype.stopInterval=function(){window.clearInterval(this.intervalId());this.intervalId(undefined);}
ip4.data.DataReader.prototype.read=function(callback){if(callback)this.callback(callback);var uri=this.uri(),data=this.data(),mimetype=this.mimetype(),adapter=this.adapter(),parse;if(adapter&&adapter.clearCache)adapter.clearCache();if(uri){if(ip4.util.isUrl(uri)){switch(mimetype){case"text/csv":d3.csv(uri,function(d){return adapter?adapter.adapt(d):d},function(error,data){callback.call(this,error,data)});break;case"text/tsv":d3.tsv(uri,function(d){return adapter?adapter.adapt(d):d},function(error,data){callback.call(this,error,data)});break;default:d3.json(uri,function(error,data){if(adapter){data.forEach(function(d){d=adapter.adapt(d);});}
callback.call(this,error,data)});}}else{data=d3.select(uri).text();}}else if(data){switch(mimetype){case"text/csv":parse=d3.csv.parse;break;case"text/tsv":parse=d3.tsv.parse;break;case"application/xml":parse=d3.xml.parse;break;default:switch(typeof data){case"string":parse=JSON.parse;break;case"function":data=data();break;case"object":data=(adapter?adapter.adapt(data):data);break;}}
if(parse)data=parse(data,function(d){return adapter?adapter.adapt(d):null});callback.call(this,null,data);}
if(this.interval())this.startInterval();}
ip4.data.TableAdapter=function(){}
ip4.tableAdapter=function(){return new ip4.data.TableAdapter();}
ip4.data.TableAdapter.prototype={constructor:{configurable:true,enumerable:true,value:ip4.data.TableAdapter,writable:true}}
ip4.data.TableAdapter.prototype.toString=function(){return"[ip4 TableAdapter]";}
ip4.data.TableAdapter.prototype.clearCache=function(){this._cache={};}
ip4.data.TableAdapter.prototype.x=function(x,parser){if(arguments.length===0)return this._x;this._x=[x,parser];return this;}
ip4.data.TableAdapter.prototype.y=function(y,parser){if(arguments.length===0)return this._y;this._y=[y,parser];return this;}
ip4.data.TableAdapter.prototype.group=function(group,parser){if(arguments.length===0)return this._group;this._group=[group,parser];return this;}
ip4.data.TableAdapter.prototype.adapt=function(row){if(ip4.log.log())console.log(this.toString()+" Adapting... row:",row,"x:",this.x(),"y:",this.y(),"group:",this.group());var x=this.x(),y=this.y(),group=this.group();if(x&&y){return{"x":(x[1]?x[1](row[x[0]]):row[x[0]]),"y":(y[1]?y[1](row[y[0]]):+row[y[0]])}}
if(group&&y){return{"name":group[1]?group[1](row[group[0]].trim()):row[group[0]].trim(),"values":y[0].map(function(sub){return{"x":sub,"y":y[1]?y[1](row[sub]):+row[sub]};})}}
if(group&&x){var self=this;var result=group[0].map(function(serie){if(!self._cache[serie])self._cache[serie]=[];self._cache[serie].push({"x":x[1]?x[1](row[x[0]].trim()):row[x[0]].trim(),"y":group[1]?group[1](row[serie]):+row[serie]});return{"name":serie,"values":self._cache[serie]}});return result;}}
if(!ip4.decorator)ip4.decorator={}
ip4.decorator.AxisDecorator=function(){}
ip4.decorator.AxisDecorator.prototype={constructor:{configurable:true,enumerable:true,value:ip4.decorator.AxisDecorator,writable:true}}
ip4.decorator.AxisDecorator.prototype.toString=function(){return"[ip4 AxisDecorator]";}
ip4.decorator.AxisDecorator.prototype.draw=function(g,xAxis,yAxis,x,y,w,h,xLabel,yLabel){if(ip4.log.log())console.log(this.toString()+" Drawing...");g.append("g").attr("class","x axis").attr("transform","translate(0,"+h+")").append("text").attr("class","label").attr("x",w).attr("dy","-.71em").style("text-anchor","end").text(xLabel);g.append("g").attr("class","y axis").append("text").attr("class","label").attr("transform","rotate(-90)").attr("y",6).attr("dy",".71em").style("text-anchor","end").text(yLabel);}
ip4.decorator.AxisDecorator.prototype.redraw=function(data,g,xAxis,yAxis,xScale,yScale,width,height,transitions){if(ip4.log.log())console.log(this.toString()+" Redrawing...");xAxis.scale(xScale);yAxis.scale(yScale);transitions.xAxis.each(function(){g.select(".x.axis").attr("transform","translate(0,"+height+")").transition().call(xAxis);});transitions.yAxis.each(function(){g.select(".y.axis").transition().call(yAxis);});var zero=g.select(".y.axis").selectAll(".zero").data(function(){return yScale.domain()[0]<0?[{x1:1,y1:yScale(0),x2:width-1,y2:yScale(0)}]:[];});transitions.zeroline.each(function(){zero.transition().attr("x1",function(d){return d.x1;}).attr("y1",function(d){return d.y1;}).attr("x2",function(d){return d.x2;}).attr("y2",function(d){return d.y2;})});zero.enter().append("line").attr("class","baseline zero").attr("x1",function(d){return d.x1;}).attr("y1",function(d){return d.y1;}).attr("x2",function(d){return d.x2;}).attr("y2",function(d){return d.y2;});zero.exit().remove();}
ip4.decorator.LegendDecorator=function(){}
ip4.decorator.LegendDecorator.prototype={constructor:{configurable:true,enumerable:true,value:ip4.decorator.LegendDecorator,writable:true}}
ip4.decorator.LegendDecorator.prototype.toString=function(){return"[ip4 LegendDecorator]";}
ip4.decorator.LegendDecorator.prototype.draw=function(){if(ip4.log.log())console.log(this.toString()+" Drawing...");}
ip4.decorator.LegendDecorator.prototype.redraw=function(g,w,data,color){if(ip4.log.log())console.log(this.toString()+" Redrawing...");var legends=g.selectAll(".legend").data(data);legends.attr("class","legend update");var legend=legends.enter().append("g").attr("class","legend enter").attr("transform",function(d,i){return"translate(-1,"+(12+i*16)+")";});legend.append("rect").attr("x",w-12).attr("width",12).attr("height",12).style("fill",function(d,i){return color(d)});legend.append("text").attr("x",w-18).attr("y",5).attr("dy",".35em").style("text-anchor","end").text(function(d){return d;});legends.exit().attr("class","legend exit").remove();}
ip4.decorator.TooltipDecorator=function(){}
ip4.decorator.TooltipDecorator.prototype={constructor:{configurable:true,enumerable:true,value:ip4.decorator.TooltipDecorator,writable:true}}
ip4.decorator.TooltipDecorator.prototype.toString=function(){return"[ip4 TooltipDecorator]";}
ip4.decorator.TooltipDecorator.prototype.draw=function(){if(d3.select(".ip4.tooltip").empty()){d3.select("body").append("div").attr("class","ip4 tooltip").on("mousedown",function(d){d3.select(this).classed("selected",false);d3.event.sourceEvent.stopPropagation();});}}
if(!ip4.template)ip4.template={};ip4.template.BarChart=function(){ip4.document.SVGDocument.call(this);this.axisDecorator=new ip4.decorator.AxisDecorator();this.tooltipDecorator=new ip4.decorator.TooltipDecorator();}
ip4.barChart=function(){return new ip4.template.BarChart();}
ip4.template.BarChart.prototype=Object.create(ip4.document.SVGDocument.prototype,{constructor:{configurable:true,enumerable:true,value:ip4.template.BarChart,writable:true}});ip4.template.BarChart.prototype.toString=function(){return"[ip4 BarChart]";}
ip4.template.BarChart.prototype.defaultConfiguration=function(){return{"data":{"reader":ip4.dataReader().data(function(){return[{"x":"Group A","y":ip4.util.getRandomMinMax(-1000,1000)},{"x":"Group B","y":ip4.util.getRandomMinMax(-1000,1000)},{"x":"Group C","y":ip4.util.getRandomMinMax(-1000,1000)},{"x":"Group D","y":ip4.util.getRandomMinMax(-1000,1000)},{"x":"Group E","y":ip4.util.getRandomMinMax(-1000,1000)}]})},"svg":{"size":{"margin":{"top":20,"right":10,"bottom":40,"left":60}},"desc":"ip4 Bar Chart","metadata":{"dc:format":"application/ip4"}},"d3":{"xScale":d3.scale.ordinal(),"innerBands":0.15,"outerBands":0.3,"yScale":d3.scale.linear().nice(),"yLabel":"y","xAxis":d3.svg.axis(),"yAxis":d3.svg.axis().orient("left").tickFormat(d3.format(",.2f")),"color":d3.scale.ordinal().range(ip4.color.default_palette),"transitions":{"groups":d3.transition().duration(1500).ease("linear"),"xAxis":d3.transition().duration(1500).ease("linear"),"yAxis":d3.transition().duration(1500).ease("linear"),"zeroline":d3.transition().duration(1500).ease("linear")}}}}
ip4.template.BarChart.prototype.draw=function(){if(ip4.log.log())console.log(this.toString()+" Drawing with configuration:",this.configuration());if(ip4.log.time())console.time(this.toString()+" Draw");ip4.document.SVGDocument.prototype.draw.call(this);var conf=this.configuration(),parent=conf.parentElement,size=conf.svg.size,x=conf.d3.xScale,y=conf.d3.yScale,innerBands=conf.d3.innerBands,outerBands=conf.d3.outerBands,xAxis=conf.d3.xAxis,yAxis=conf.d3.yAxis,yLabel=conf.d3.yLabel;parent.select("svg.ip4").classed("barChart",true);var w=size.width-size.margin.right-size.margin.left,h=size.height-size.margin.top-size.margin.bottom;x.rangeRoundBands([0,w],innerBands,outerBands);y.range([h,0]);this.axisDecorator.draw(parent.select("g.main"),xAxis,yAxis,x,y,w,h,null,yLabel);this.tooltipDecorator.draw();conf.data.reader.read(this.redraw.bind(this));if(ip4.log.time())console.timeEnd(this.toString()+" Draw");return this;}
ip4.template.BarChart.prototype.redraw=function(error,data){if(ip4.log.log())console.log(this.toString()+" Redrawing...");if(ip4.log.time())console.time(this.toString()+" Redraw");ip4.document.SVGDocument.prototype.redraw.call(this,error,data);var conf=this.configuration(),parent=conf.parentElement,size=conf.svg.size,x=conf.d3.xScale,y=conf.d3.yScale,xAxis=conf.d3.xAxis,yAxis=conf.d3.yAxis,yLabel=conf.d3.yLabel,color=conf.d3.color,transitions=conf.d3.transitions;var w=size.width-size.margin.right-size.margin.left,h=size.height-size.margin.top-size.margin.bottom;var g=parent.select("g.main"),tooltip=d3.selectAll(".tooltip",".ip4");x.domain(data.map(function(d){return d.x;}));y.domain([d3.min(data,function(d){return d.y>0?0:d.y;}),d3.max(data,function(d){return d.y;})]);var groups=g.selectAll(".group").data(data,function(d){return d.x;});groups.attr("class","group update").attr("width",x.rangeBand()).attr("x",function(d){return x(d.x);});groups.enter().append("rect").attr("class","group enter").attr("width",x.rangeBand()).attr("x",function(d){return x(d.x);}).style("fill",function(d){return color(d.x);}).on("mouseover",function(d){d3.select(this).classed("selected",true);tooltip.html((xAxis.tickFormat()?xAxis.tickFormat()(d.x):d.x)
+"<br/>"
+yLabel.substring(0,20)+": "+(yAxis.tickFormat()?yAxis.tickFormat()(d.y):d.y)).style("left",(d3.event.pageX+7)+"px").style("top",(d3.event.pageY-28)+"px").classed("selected",true);}).on("mousemove",function(d){tooltip.style("left",(d3.event.pageX+7)+"px").style("top",(d3.event.pageY-28)+"px");}).on("mouseout",function(d){d3.select(this).classed("selected",false);tooltip.html("").classed("selected",false);});groups.exit().attr("class","group exit").remove();transitions.groups.each(function(){groups.transition().attr("y",function(d){return d.y>0?y(d.y):y(0);}).attr("height",function(d){return d.y>0?h-y(d.y+y.domain()[0]):h-y(y.domain()[0]-d.y);})});this.axisDecorator.redraw(data,g,xAxis,yAxis,x,y,w,h,transitions);if(ip4.log.time())console.timeEnd(this.toString()+" Redraw");return this;}
if(!ip4.template)ip4.template={};ip4.template.LineChart=function(){ip4.document.SVGDocument.call(this);this.axisDecorator=new ip4.decorator.AxisDecorator();this.tooltipDecorator=new ip4.decorator.TooltipDecorator();}
ip4.lineChart=function(){return new ip4.template.LineChart();}
ip4.template.LineChart.prototype=Object.create(ip4.document.SVGDocument.prototype,{constructor:{configurable:true,enumerable:true,value:ip4.template.LineChart,writable:true}});ip4.template.LineChart.prototype.toString=function(){return"[ip4 LineChart]";}
ip4.template.LineChart.prototype.defaultConfiguration=function(){var min=-1000,max=1000;return{"data":{"reader":ip4.dataReader().data(function(){return[{"x":0,"y":ip4.util.getRandomMinMax(min,max)},{"x":1,"y":ip4.util.getRandomMinMax(min,max)},{"x":2,"y":ip4.util.getRandomMinMax(min,max)},{"x":3,"y":ip4.util.getRandomMinMax(min,max)},{"x":4,"y":ip4.util.getRandomMinMax(min,max)},{"x":5,"y":ip4.util.getRandomMinMax(min,max)},{"x":6,"y":ip4.util.getRandomMinMax(min,max)},{"x":7,"y":ip4.util.getRandomMinMax(min,max)},{"x":8,"y":ip4.util.getRandomMinMax(min,max)},{"x":9,"y":ip4.util.getRandomMinMax(min,max)},{"x":10,"y":ip4.util.getRandomMinMax(min,max)},{"x":11,"y":ip4.util.getRandomMinMax(min,max)},{"x":12,"y":ip4.util.getRandomMinMax(min,max)},{"x":13,"y":ip4.util.getRandomMinMax(min,max)},{"x":14,"y":ip4.util.getRandomMinMax(min,max)},{"x":15,"y":ip4.util.getRandomMinMax(min,max)},{"x":16,"y":ip4.util.getRandomMinMax(min,max)},{"x":17,"y":ip4.util.getRandomMinMax(min,max)},{"x":18,"y":ip4.util.getRandomMinMax(min,max)},{"x":19,"y":ip4.util.getRandomMinMax(min,max)}]})},"svg":{"size":{"margin":{"top":20,"right":10,"bottom":40,"left":60}},"metadata":{"dc:format":"application/ip4"}},"d3":{"xScale":d3.scale.linear().nice(),"yScale":d3.scale.linear().nice(),"line":d3.svg.line().interpolate("linear"),"color":ip4.color.default_palette[2],"dotRadius":6,"xLabel":"x","yLabel":"y","xAxis":d3.svg.axis().tickFormat(d3.format(",.2f")),"yAxis":d3.svg.axis().orient("left").tickFormat(d3.format(",.2f")),"transitions":{"lines":d3.transition().duration(1500).ease("linear"),"dots":d3.transition().duration(1500).ease("linear"),"xAxis":d3.transition().duration(1500).ease("linear"),"yAxis":d3.transition().duration(1500).ease("linear"),"zeroline":d3.transition().duration(1500).ease("linear")}}}}
ip4.template.LineChart.prototype.draw=function(){if(ip4.log.log())console.log(this.toString()+" Drawing with configuration:",this.configuration());if(ip4.log.time())console.time(this.toString()+" Draw");ip4.document.SVGDocument.prototype.draw.call(this);var conf=this.configuration(),parent=conf.parentElement,size=conf.svg.size,x=conf.d3.xScale,y=conf.d3.yScale,xAxis=conf.d3.xAxis,yAxis=conf.d3.yAxis,xLabel=conf.d3.xLabel,yLabel=conf.d3.yLabel;parent.select("svg.ip4").classed("lineChart",true);var w=size.width-size.margin.right-size.margin.left,h=size.height-size.margin.top-size.margin.bottom;x.range([0,w]);y.range([h,0]);this.axisDecorator.draw(parent.select("g.main"),xAxis,yAxis,x,y,w,h,xLabel,yLabel);this.tooltipDecorator.draw();parent.select("svg").append("defs").append("clipPath").attr("id","clip").append("rect").attr("width",w+10).attr("height",h+10).attr("transform","translate(0,-10)");conf.data.reader.read(this.redraw.bind(this));if(ip4.log.time())console.timeEnd(this.toString()+" Draw");return this;}
ip4.template.LineChart.prototype.redraw=function(error,data){if(ip4.log.log())console.log(this.toString()+" Redrawing...");if(ip4.log.time())console.time(this.toString()+" Redraw");ip4.document.SVGDocument.prototype.redraw.call(this,error,data);var conf=this.configuration(),parent=conf.parentElement,size=conf.svg.size,x=conf.d3.xScale,y=conf.d3.yScale,line=conf.d3.line,color=conf.d3.color,dotRadius=conf.d3.dotRadius,xAxis=conf.d3.xAxis,yAxis=conf.d3.yAxis,xLabel=conf.d3.xLabel,yLabel=conf.d3.yLabel,transitions=conf.d3.transitions;var w=size.width-size.margin.right-size.margin.left,h=size.height-size.margin.top-size.margin.bottom;var g=parent.select("g.main"),message=parent.select("g.message"),tooltip=d3.selectAll(".tooltip",".ip4");if(error){message.append("text").text(error);return;}
line.x(function(d){return x(d.x);}).y(function(d){return y(d.y);});x.domain(d3.extent(data,function(d){return d.x;}));y.domain(d3.extent(data,function(d){return d.y;}));this.axisDecorator.redraw(data,g,xAxis,yAxis,x,y,w,h,transitions);var lines=g.selectAll(".line").data(data);var dots=g.selectAll(".dot").data(data);lines.attr("class","line update").style("stroke",function(d){return color;});dots.attr("class","dot update");var path=lines.enter().append("g").attr("clip-path","url(#clip)").append("path").attr("class","line enter").style("stroke",function(d){return color;}).attr("d",line(data));dots.enter().append("g").attr("clip-path","url(#clip)").append("circle").attr("class","dot enter").style("fill",function(d){return color;}).attr("cx",function(d){return x(d.x);}).attr("cy",function(d){return y(d.y);}).attr("r",dotRadius).on("mouseover",function(d){d3.select(this).classed("selected",true);tooltip.html(xLabel.substring(0,20)+": "+(xAxis.tickFormat()?xAxis.tickFormat()(d.x):d.x)
+"<br/>"
+yLabel.substring(0,20)+": "+(yAxis.tickFormat()?yAxis.tickFormat()(d.y):d.y)).style("left",(d3.event.pageX+7)+"px").style("top",(d3.event.pageY-28)+"px").classed("selected",true);}).on("mousemove",function(d){tooltip.style("left",(d3.event.pageX+7)+"px").style("top",(d3.event.pageY-28)+"px");}).on("mouseout",function(d){d3.select(this).classed("selected",false);tooltip.html("").classed("selected",false);});lines.exit().attr("class","line exit").style("stroke",function(d){return color;}).remove();dots.exit().attr("class","dot exit").remove();transitions.lines.each(function(){lines.transition().attr("d",function(d){return line(data);});});transitions.dots.each(function(){dots.transition().attr("cx",function(d){return x(d.x);}).attr("cy",function(d){return y(d.y);});});if(ip4.log.time())console.timeEnd(this.toString()+" Redraw");return this;}
if(!ip4.template)ip4.template={};ip4.template.PieChart=function(){ip4.document.SVGDocument.call(this);this.tooltipDecorator=new ip4.decorator.TooltipDecorator();}
ip4.pieChart=function(){return new ip4.template.PieChart();}
ip4.template.PieChart.prototype=Object.create(ip4.document.SVGDocument.prototype,{constructor:{configurable:true,enumerable:true,value:ip4.template.PieChart,writable:true}});ip4.template.PieChart.prototype.toString=function(){return"[ip4 PieChart]";}
ip4.template.PieChart.prototype.defaultConfiguration=function(){var min=200,max=1000;return{"data":{"reader":ip4.dataReader().data(function(){return[{"x":"Group A","y":ip4.util.getRandomMinMax(min,max)},{"x":"Group B","y":ip4.util.getRandomMinMax(min,max)},{"x":"Group C","y":ip4.util.getRandomMinMax(min,max)},{"x":"Group D","y":ip4.util.getRandomMinMax(min,max)},{"x":"Group E","y":ip4.util.getRandomMinMax(min,max)}]})},"svg":{"size":{"margin":{"top":20,"right":10,"bottom":40,"left":10}},"metadata":{"dc:format":"application/ip4"}},"d3":{"pie":d3.layout.pie().sort(null),"arc":d3.svg.arc(),"innerRadius":0.33,"color":d3.scale.ordinal().range(ip4.color.default_palette),"yFormat":d3.format(",.2f"),"transitions":{"path":d3.transition().duration(1500).ease("linear"),"label":d3.transition().duration(1500).ease("linear")}}}}
ip4.template.PieChart.prototype.draw=function(){if(ip4.log.log())console.log(this.toString()+" Drawing with configuration:",this.configuration());if(ip4.log.time())console.time(this.toString()+" Draw");ip4.document.SVGDocument.prototype.draw.call(this);var conf=this.configuration(),parent=conf.parentElement,size=conf.svg.size;parent.select("svg.ip4").classed("pieChart",true);var w=size.width-size.margin.right-size.margin.left,h=size.height-size.margin.top-size.margin.bottom,radius=Math.min(w,h)/2;parent.select("g.main").attr("transform","translate("+w/2+","+h/2+")");conf.d3.pie.value(function(d){return+d.y;});conf.d3.arc.outerRadius(radius);conf.d3.arc.innerRadius(conf.d3.innerRadius*radius);this.tooltipDecorator.draw();conf.data.reader.read(this.redraw.bind(this));if(ip4.log.time())console.timeEnd(this.toString()+" Draw");return this;}
ip4.template.PieChart.prototype.redraw=function(error,data){if(ip4.log.log())console.log(this.toString()+" Redrawing...");if(ip4.log.time())console.time(this.toString()+" Redraw");ip4.document.SVGDocument.prototype.redraw.call(this,error,data);var conf=this.configuration(),parent=conf.parentElement,size=conf.svg.size,pie=conf.d3.pie,arc=conf.d3.arc,xFormat=conf.d3.xFormat,yFormat=conf.d3.yFormat,color=conf.d3.color,transitions=conf.d3.transitions;var w=size.width-size.margin.right-size.margin.left,h=size.height-size.margin.top-size.margin.bottom;var g=parent.select("g.main"),tooltip=d3.selectAll(".tooltip",".ip4");var arcs=g.datum(data).selectAll("g");var path=arcs.select("path").data(pie).attr("class","arc update");var label=arcs.select("text").data(pie).attr("class","text update");transitions.path.each(function(){path.transition().attrTween("d",arcTween);});transitions.label.each(function(){label.transition().attr("transform",function(d){return"translate("+arc.centroid(d)+")";});});var gEnter=path.enter().append("g");gEnter.append("path").attr("class","arc enter").attr("fill",function(d){return color(d.data.x);}).attr("d",arc).each(function(d){this._current=d;}).on("mouseover",function(d){d3.select(this).classed("selected",true);tooltip.html((xFormat?xFormat()(d.data.x):d.data.x)
+"<br/>"
+(yFormat?yFormat(d.data.y):d.data.y)).style("left",(d3.event.pageX+7)+"px").style("top",(d3.event.pageY-28)+"px").classed("selected",true);}).on("mousemove",function(d){tooltip.style("left",(d3.event.pageX+7)+"px").style("top",(d3.event.pageY-28)+"px");}).on("mouseout",function(d){d3.select(this).classed("selected",false);tooltip.html("").classed("selected",false);});gEnter.append("text").attr("class","text enter").attr("transform",function(d){return"translate("+arc.centroid(d)+")";}).attr("dy",".35em").style("text-anchor","middle").text(function(d){return d.data.x;}).each(function(d){this._current=d;});function arcTween(a){var i=d3.interpolate(this._current,a);this._current=i(0);return function(t){return arc(i(t));};}
path.exit().remove();if(ip4.log.time())console.timeEnd(this.toString()+" Redraw");return this;}